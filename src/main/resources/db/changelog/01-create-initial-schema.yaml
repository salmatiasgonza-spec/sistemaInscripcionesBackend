databaseChangeLog:

  - changeSet:
      id: 1
      author: salvio-matias
      changes:
        
        # ----------------------------------------------------
        # 1. CREACIÓN DE TABLA: curso
        # ----------------------------------------------------
        - createTable:
            tableName: curso
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: nombre
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: descripcion
                  type: VARCHAR(255)
              - column:
                  name: creditos
                  type: INTEGER
        
        # ----------------------------------------------------
        # 2. CREACIÓN DE TABLA: alumno
        # ----------------------------------------------------
        - createTable:
            tableName: alumno
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: nombres
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: apellidos
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: ci
                  type: VARCHAR(255)
                  constraints:
                    unique: true # DNI debería ser único
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(255)
                  constraints:
                    unique: true # Email debería ser único
                    nullable: false

        # ----------------------------------------------------
        # 3. CREACIÓN DE TABLA: usuario (para Spring Security)
        # ----------------------------------------------------
        - createTable:
            tableName: usuario
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: username
                  type: VARCHAR(255)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: password
                  type: VARCHAR(255)
                  constraints:
                    nullable: false
              - column:
                  name: role
                  type: VARCHAR(50) # Ejemplo: 'ADMIN', 'ALUMNO', 'DOCENTE'

        # ----------------------------------------------------
        # 4. CREACIÓN DE TABLA: matricula (Relación Alumno-Curso)
        # ----------------------------------------------------
        - createTable:
            tableName: inscripcion
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: fecha_inscripcion
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: alumno_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: curso_id
                  type: BIGINT
                  constraints:
                    nullable: false

        # ----------------------------------------------------
        # 5. CREACIÓN DE CLAVES FORÁNEAS (Foreign Keys)
        # ----------------------------------------------------
        - addForeignKeyConstraint:
            baseTableName: inscripcion
            baseColumnNames: alumno_id
            constraintName: fk_matricula_alumno
            referencedTableName: alumno
            referencedColumnNames: id
            onDelete: RESTRICT # Si se elimina el alumno, se eliminan sus matrículas.

        - addForeignKeyConstraint:
            baseTableName: inscripcion
            baseColumnNames: curso_id
            constraintName: fk_matricula_curso
            referencedTableName: curso
            referencedColumnNames: id
            onDelete: RESTRICT # Si se elimina el curso, se eliminan las matrículas asociadas.